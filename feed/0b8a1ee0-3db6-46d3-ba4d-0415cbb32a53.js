{
  "id": "0b8a1ee0-3db6-46d3-ba4d-0415cbb32a53",
  "title": "使用div创建选取框",
  "postDate": "2015-04-09 15:21",
  "content": "<p>使用div实现了选取框效果.</p><p>代码如下</p><pre class=\\\"language-html line-numbers\\\"><code>&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n&lt;head&gt;\\n    &lt;title&gt;myCanvasTest&lt;/title&gt;\\n    &lt;style type=\\\"text/css\\\"&gt;\\n<span style=\\\"color: #000000;\\\">    #selection{\\n</span><span style=\\\"color: #000000;\\\">        border: 3px red solid;</span>\\n<span style=\\\"color: #000000;\\\">        display: none;</span>\\n<span style=\\\"color: #000000;\\\">        position: absolute;</span>\\n\\n<span style=\\\"color: #000000;\\\">    }</span>\\n    *<span style=\\\"color: #000000;\\\">{</span>\\n<span style=\\\"color: #000000;\\\">        cursor: crosshair;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n    &lt;/style&gt;\\n&lt;/head&gt;\\n&lt;body&gt;\\n    &lt;div id=\\\"selection\\\"&gt;&lt;/div&gt;\\n&lt;/body&gt;\\n&lt;script type=\\\"text/javascript\\\"&gt;\\n    <span style=\\\"color: #0000ff;\\\">var</span> selection,                            <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">存储坐标量(方便用)</span>\\n    flag         = <span style=\\\"color: #0000ff;\\\">false</span>,                    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">作为是否在鼠标点击时的移动标记</span>\\n    selectionDiv     = document.getElementById(\\\"selection\\\");    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">获取选取框div对象</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">初始化坐标对象</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> init () {</span>\\n     selection =<span style=\\\"color: #000000;\\\"> {</span>\\n        top    :0<span style=\\\"color: #000000;\\\">,</span>\\n        left    :0<span style=\\\"color: #000000;\\\">,</span>\\n        width    :0<span style=\\\"color: #000000;\\\">,</span>\\n        height    :0\\n<span style=\\\"color: #000000;\\\">    };</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">鼠标按下,记录坐标</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> setLocation (x, y) {</span>\\n    selection.left =<span style=\\\"color: #000000;\\\"> x;</span>\\n    selection.top =<span style=\\\"color: #000000;\\\"> y;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">鼠标移动计算距离存入宽高</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> moveLocation (x, y) {</span>\\n    selection.width = selection.left -<span style=\\\"color: #000000;\\\"> x;</span>\\n    selection.height = selection.top -<span style=\\\"color: #000000;\\\"> y;</span>\\n<span style=\\\"color: #000000;\\\">    moveIt();        </span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">更新div坐标尺寸信息</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> moveIt () {</span>\\n<span style=\\\"color: #000000;\\\">    console.log(selection);</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">高度宽度小于0时说明拖拽x,y为正值,如小于0说明拖动为反方向.需重新计算top及left保证拖拽效果</span>\\n    selectionDiv.style.top     = (selection.height &lt; 0 ? \\n<span style=\\\"color: #000000;\\\">                    selection.top :             </span>\\n                    selection.top -<span style=\\\"color: #000000;\\\"> selection.height) </span>\\n                    + \\\"px\\\"<span style=\\\"color: #000000;\\\">;</span>\\n    selectionDiv.style.left     = (selection.width &lt; 0 ? \\n<span style=\\\"color: #000000;\\\">                    selection.left : </span>\\n                    selection.left -<span style=\\\"color: #000000;\\\"> selection.width) </span>\\n                    + \\\"px\\\"<span style=\\\"color: #000000;\\\">;</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">Math.abs()方法返回绝对值</span>\\n    selectionDiv.style.width     =<span style=\\\"color: #000000;\\\"> Math.abs(selection.width) </span>\\n                    + \\\"px\\\"<span style=\\\"color: #000000;\\\">;</span>\\n    selectionDiv.style.height     =<span style=\\\"color: #000000;\\\"> Math.abs(selection.height) </span>\\n                    + \\\"px\\\"<span style=\\\"color: #000000;\\\">;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">显示选取框div</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> showIt () {</span>\\n    selectionDiv.style.display = \\\"block\\\"<span style=\\\"color: #000000;\\\">;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">隐藏选取框div</span>\\n    <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> hideIt () {</span>\\n    selectionDiv.style.display = \\\"none\\\"<span style=\\\"color: #000000;\\\">;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">鼠标按下触发事件</span>\\n    window.onmousedown = <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> (e) {</span>\\n    <span style=\\\"color: #0000ff;\\\">var</span> x =<span style=\\\"color: #000000;\\\"> e.clientX,</span>\\n        y =<span style=\\\"color: #000000;\\\"> e.clientY;</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">初始化坐标对象</span>\\n<span style=\\\"color: #000000;\\\">    init();</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">显示div对象</span>\\n<span style=\\\"color: #000000;\\\">    showIt();</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">设置top,left值.作为本次拖拽的原点</span>\\n<span style=\\\"color: #000000;\\\">    setLocation(x, y);</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">调用移动方法</span>\\n<span style=\\\"color: #000000;\\\">    moveIt();</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">将标记打开</span>\\n    flag = <span style=\\\"color: #0000ff;\\\">true</span><span style=\\\"color: #000000;\\\">;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">鼠标移动时触发</span>\\n    window.onmousemove = <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> (e) {</span>\\n    <span style=\\\"color: #0000ff;\\\">var</span> x =<span style=\\\"color: #000000;\\\"> e.clientX,</span>\\n        y =<span style=\\\"color: #000000;\\\"> e.clientY;</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">当标记开启时,触发事件</span>\\n    <span style=\\\"color: #0000ff;\\\">if</span><span style=\\\"color: #000000;\\\">(flag)</span>\\n<span style=\\\"color: #000000;\\\">        moveLocation(x, y);</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">鼠标抬起,触发事件,将div隐藏,清除坐标对象,关闭标记</span>\\n    window.onmouseup = <span style=\\\"color: #0000ff;\\\">function</span><span style=\\\"color: #000000;\\\"> (e) {</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">隐藏div</span>\\n<span style=\\\"color: #000000;\\\">    hideIt();</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">清除坐标信息</span>\\n<span style=\\\"color: #000000;\\\">    init();</span>\\n    <span style=\\\"color: #008000;\\\">\\/\\/</span><span style=\\\"color: #008000;\\\">关闭标记</span>\\n    flag = <span style=\\\"color: #0000ff;\\\">false</span><span style=\\\"color: #000000;\\\">;</span>\\n<span style=\\\"color: #000000;\\\">    }</span>\\n\\n&lt;/script&gt;\\n&lt;/html&gt;</code></pre><p>感觉在编码的时候.卡在了x,y都为负值的地方.</p><p>为了保证在x,y都为负值时还有拖拽效果.必须要将div的位置移动.</p><p>看起来就像拖拽一样.实则在更新大小的同时更新了div的坐标位置</p>"
}
